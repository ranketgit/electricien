---
interface Props {
  post: {
    slug: string;
    data: {
      title: string;
      description: string;
      date: Date;
      image?: string;
      categories?: string[];
    };
  };
  index: number;
}

const { post, index } = Astro.props;
const { title, description, date, image, categories } = post.data;

const formattedDate = new Date(date).toLocaleDateString('fr-BE', {
  year: 'numeric',
  month: 'long',
  day: 'numeric'
});
---

<a 
  href={`/blog/${post.slug}/`} 
  class="bg-gray-50 p-6 rounded-2xl shadow-lg hover:shadow-xl transition-shadow duration-300 group block"
  data-aos="fade-up"
  data-aos-delay={((index % 3) * 100).toString()}
>
  {image && (
    <div class="overflow-hidden rounded-xl mb-4">
      <img 
        src={image} 
        alt={title}
        class="w-full h-48 object-cover group-hover:scale-105 transition-transform duration-300"
        loading={index < 6 ? "eager" : "lazy"}
      />
    </div>
  )}
  
  {categories && categories.length > 0 && (
    <div class="flex flex-wrap gap-2 mb-3">
      {categories.slice(0, 2).map((category) => (
        <span class="text-xs font-semibold bg-yellow-100 text-yellow-700 px-3 py-1 rounded-full">
          {category}
        </span>
      ))}
    </div>
  )}
  
  <h2 class="text-xl font-semibold text-gray-900 group-hover:text-yellow-600 transition-colors mb-3 line-clamp-2">
    {title}
  </h2>
  
  <p class="text-gray-600 text-sm mb-4 line-clamp-3 leading-relaxed">
    {description}
  </p>
  
  <div class="flex items-center justify-between pt-4 border-t border-gray-200">
    <time datetime={date.toISOString()} class="text-sm text-gray-500 flex items-center">
      <svg class="w-4 h-4 mr-1.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
      </svg>
      {formattedDate}
    </time>
    <span class="text-yellow-600 font-medium text-sm flex items-center group-hover:translate-x-1 transition-transform duration-300">
      Lire plus
      <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
      </svg>
    </span>
  </div>
</a>

<style>
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  
  .line-clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>