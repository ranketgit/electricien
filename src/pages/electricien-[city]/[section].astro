---
import Layout from '../../layouts/Layout.astro'; // Adjusted path for nesting
import { data as locationsData } from '../../data/locations.ts'; // Adjusted path for nesting

export async function getStaticPaths() {
  const paths = [];
  locationsData.forEach(province => {
    province.Cities.forEach(city => {
      if (city.sections && city.sections.length > 0) {
        city.sections.forEach(section => {
          paths.push({
            params: { city: city.slug, section: section.slug },
            props: { 
              currentSection: section, 
              currentCity: city, 
              currentProvinceName: province.State 
            },
          });
        });
      }
    });
  });
  return paths;
}

const { currentSection, currentCity, currentProvinceName } = Astro.props;

const companyName = "Electricien Belge"; // As per brief
const phoneNumberDisplay = "0476/23.23.23"; // Using the number from your index.astro
const phoneNumberHref = "+32476232323";     // Using the number from your index.astro

// Meta and Title
const pageTitle = `Électricien ${currentSection.name} (${currentCity.cityName}) - Dépannage Rapide | ${companyName}`;
const metaDescription = `Votre électricien de proximité dans le quartier ${currentSection.name} à ${currentCity.cityName}. Intervention rapide pour pannes, installations et mises aux normes. Contactez ${companyName} !`;

// Hero Content
const sectionHeroImageUrl = `/images/hero-section-default.png`; // Placeholder - UPDATE THIS
const h1Content = `Électricien ${currentSection.name}, ${currentCity.cityName} : Votre Expert de Proximité`;
const heroIntroP1 = `Vous habitez ou travaillez dans le quartier de ${currentSection.name} à ${currentCity.cityName} et avez besoin d'un électricien local fiable ? Une panne électrique soudaine dans votre logement ou commerce à ${currentSection.name} ? ${companyName} est votre spécialiste de l'électricité intervenant spécifiquement dans le quartier de ${currentSection.name}, au cœur de ${currentCity.cityName}.`;
const heroIntroP2 = `Notre équipe connaît parfaitement ${currentSection.name} et ses environs, offrant des dépannages rapides et solutions électriques sur mesure.`;

// Services Section Content
const servicesTitle = `Services Électriques Dédiés au Quartier ${currentSection.name}`;
const servicesIntro = `Nous proposons l'ensemble de nos services d'électricité avec une attention particulière pour les résidents et professionnels du quartier ${currentSection.name} à ${currentCity.cityName} :`;
const sectionServices = [
    { title: `Dépannage Ultra-Rapide à ${currentSection.name}`, text: `Grâce à notre connaissance du quartier ${currentSection.name}, nous intervenons en un temps record. En cas d'urgence électrique à ${currentSection.name}, notre priorité est d'être chez vous au plus vite pour toute panne, court-circuit ou problème électrique.` },
    { title: `Installations et Rénovations Électriques à ${currentSection.name}`, text: `Que ce soit pour un appartement, une maison ou un local commercial dans le quartier ${currentSection.name}, nous réalisons vos installations (tableau, prises, éclairage) dans les règles de l'art.` },
    { title: `Mise en Conformité Spécifique à ${currentSection.name}`, text: `Nous vous accompagnons pour la mise aux normes de votre installation électrique dans le quartier ${currentSection.name}.` },
    { title: `Solutions d'Éclairage pour ${currentSection.name}`, text: `Mettez en valeur votre bien à ${currentSection.name} avec nos installations d'éclairage intérieur et extérieur.` },
    { title: `Parlophonie, Vidéophonie et Domotique à ${currentSection.name}`, text: `Renforcez la sécurité et le confort de votre domicile dans le quartier ${currentSection.name} grâce à nos solutions connectées.` }
];

// Avantages Section
const avantagesTitle = `L'Avantage d'un Électricien dans Votre Quartier ${currentSection.name}`;
const avantagesIntro = `Choisir un électricien qui connaît bien ${currentSection.name} vous apporte des bénéfices concrets :`;
const sectionAvantages = [
    { title: "Intervention Express", text: `Notre base ou nos tournées fréquentes dans ${currentCity.cityName} nous permettent d'être extrêmement réactifs dans le quartier ${currentSection.name}. Fini les longues attentes !` },
    { title: "Compréhension Locale", text: `Nous sommes familiers avec les types de bâtiments et d'installations courantes à ${currentSection.name}.` },
    { title: "Flexibilité Accrue", text: `Planifier un rendez-vous à ${currentSection.name} est plus simple grâce à notre présence locale.` },
    { title: "Un Voisin de Confiance", text: `Nous tissons des liens durables avec les habitants et commerçants de ${currentSection.name}.` }
];

// Tarifs Section
const tarifsTitle = `Tarifs pour une Intervention à ${currentSection.name}, ${currentCity.cityName}`;
const tarifsIntro = `Nos tarifs pour le quartier ${currentSection.name} sont alignés sur ceux de ${currentCity.cityName}. Voici quelques indications (susceptibles de varier) :`;
const sectionTarifsList = [
    `Dépannage Urgent à ${currentSection.name} (jour) : à partir de 150 €`,
    `Installation Prise Électrique (quartier ${currentSection.name}) : 150 € - 300 €`,
    `Devis Mise en Conformité (appartement type à ${currentSection.name}) : Estimation gratuite`
];
const tarifsOutro = `Demandez un devis précis pour votre besoin spécifique dans le quartier ${currentSection.name}.`;

// Témoignages Section
const temoignagesTitle = `Ils Nous Ont Fait Confiance à ${currentSection.name}`;
const sectionTemoignages = [
    { quote: `Enfin un électricien qui intervient vite dans le quartier ${currentSection.name} ! Problème de disjoncteur résolu en 30 minutes. Top !`, author: `Ahmed K., ${currentSection.name}, ${currentCity.cityName}` },
    { quote: `Installation de nouvelles prises dans notre bureau à ${currentSection.name}. Travail propre et rapide par ${companyName}. Je recommande pour les pros du quartier.`, author: `Société Innovatech, ${currentSection.name}` },
    { quote: `Très content du service pour la mise en conformité de mon appartement à ${currentSection.name}. L'électricien de ${companyName} a été clair et pédagogue.`, author: `Chloé M., ${currentSection.name}, ${currentCity.cityName}` }
];

// FAQ Section
const faqTitle = `FAQ – Électricien Quartier ${currentSection.name}`;
const sectionFaqItems = [
    { q: `Couvrez-vous vraiment tout le quartier de ${currentSection.name} ?`, a: `Oui, nos équipes interviennent régulièrement et sans exception dans l'ensemble du quartier ${currentSection.name} à ${currentCity.cityName}.` },
    { q: `Y a-t-il des frais de déplacement supplémentaires pour ${currentSection.name} ?`, a: `Non, pour les interventions dans le quartier ${currentSection.name}, nos frais de déplacement sont inclus dans nos forfaits standards pour ${currentCity.cityName}.` },
    { q: `Quel est le meilleur moment pour vous contacter depuis ${currentSection.name} ?`, a: `Pour les urgences à ${currentSection.name}, nous sommes joignables 24/7. Pour les projets, contactez-nous durant les heures de bureau pour un devis rapide.` }
];

// Final CTA
const finalCtaHeading = "Contactez-nous !";
const finalCtaText = `Habitants et professionnels du quartier ${currentSection.name}, ne cherchez plus votre électricien !`;
const finalCtaButton1Text = `Devis Gratuit pour ${currentSection.name}`;
const finalCtaButton1Link = "/contact/"; // Or a specific quote link
const finalCtaButton2Text = `Appelez votre expert local au ${phoneNumberDisplay}`;
const finalCtaButton2Link = `tel:${phoneNumberHref}`;
---

<Layout title={pageTitle} description={metaDescription}>
    <section class="bg-white text-gray-800 pt-16 md:pt-24">
        <div class="container mx-auto px-6 text-center pb-8 md:pb-12">
            <h1 class="text-4xl sm:text-5xl font-extrabold text-gray-900 leading-tight mb-6">
                {h1Content}
            </h1>
            <p class="text-lg md:text-xl text-gray-700 mb-4 max-w-3xl mx-auto">
                {heroIntroP1}
            </p>
            <p class="text-lg md:text-xl text-gray-700 max-w-3xl mx-auto">
                {heroIntroP2}
            </p>
        </div>
        <div class="container mx-auto px-4 sm:px-6 pb-16 md:pb-20">
             <img 
                src={sectionHeroImageUrl} 
                alt={`Électricien professionnel dans le quartier ${currentSection.name}, ${currentCity.cityName}`} 
                class="w-full h-auto rounded-2xl shadow-2xl mx-auto max-w-3xl md:max-w-4xl lg:max-w-5xl" 
                loading="lazy"
             />
        </div>
    </section>

    <section class="py-16 md:py-20 bg-white">
        <div class="container mx-auto px-6">
            <h2 class="text-3xl md:text-4xl font-bold text-gray-900 text-center mb-6">{servicesTitle}</h2>
            <p class="text-lg text-gray-700 text-center mb-12 max-w-3xl mx-auto">{servicesIntro}</p>
            <div class="space-y-8 grid grid-cols-1 md:grid-cols-2 gap-8">
                {sectionServices.map(service => (
                    <div class="bg-white p-6 rounded-2xl shadow-xl">
                        <h3 class="text-xl font-semibold text-blue-700 mb-3">{service.title}</h3>
                        <p class="text-gray-600 leading-relaxed">{service.text}</p>
                    </div>
                ))}
            </div>
        </div>
    </section>

    <section class="py-16 md:py-20 bg-white">
        <div class="container mx-auto px-6">
            <h2 class="text-3xl md:text-4xl font-bold text-gray-900 text-center mb-6">{avantagesTitle}</h2>
            <p class="text-lg text-gray-700 text-center mb-12 max-w-3xl mx-auto">{avantagesIntro}</p>
            <div class="grid md:grid-cols-2 gap-8">
                {sectionAvantages.map(avantage => (
                    <div class="bg-white p-6 rounded-2xl shadow-xl h-full">
                        <h3 class="text-xl font-semibold text-blue-700 mb-2">{avantage.title}</h3>
                        <p class="text-gray-600 text-sm leading-relaxed">{avantage.text}</p>
                    </div>
                ))}
            </div>
        </div>
    </section>

    <section class="py-16 md:py-20 bg-white">
        <div class="container mx-auto px-6 max-w-3xl">
            <h2 class="text-3xl md:text-4xl font-bold text-gray-900 text-center mb-6">{tarifsTitle}</h2>
            <div class="bg-white p-6 md:p-8 rounded-2xl shadow-xl">
                <p class="text-gray-700 mb-6 leading-relaxed">{tarifsIntro}</p>
                <ul class="list-disc list-inside text-gray-600 space-y-2 mb-6">
                    {sectionTarifsList.map(item => <li>{item}</li>)}
                </ul>
                <p class="text-gray-700 font-medium italic">{tarifsOutro}</p>
            </div>
        </div>
    </section>

    <section class="py-16 md:py-24 bg-white">
        <div class="container mx-auto px-6">
            <h2 class="text-3xl md:text-4xl font-bold text-gray-900 text-center mb-12">{temoignagesTitle}</h2>
            <div class="grid md:grid-cols-1 lg:grid-cols-3 gap-8"> {/* Adjusted grid for 3 testimonials */}
                {sectionTemoignages.map(testimonial => (
                    <div class="bg-white p-8 rounded-2xl shadow-xl text-left flex flex-col h-full">
                        {/* <p class="text-gray-700 font-semibold mb-2">"{testimonial.context}"</p> Context removed from brief for this page */}
                        <p class="text-gray-600 italic mb-4 flex-grow">"{testimonial.quote}"</p>
                        <p class="text-right font-medium text-gray-800 mt-auto">- {testimonial.author}</p>
                    </div>
                ))}
            </div>
        </div>
    </section>

    <section class="py-16 md:py-24 bg-white">
        <div class="container mx-auto px-6 max-w-3xl">
            <h2 class="text-3xl md:text-4xl font-bold text-gray-900 text-center mb-12">{faqTitle}</h2>
            <div class="space-y-6">
                {sectionFaqItems.map((item, index) => (
                    <details class="bg-white p-4 md:p-6 rounded-2xl shadow-xl group" open={index === 0}>
                        <summary class="flex justify-between items-center font-semibold text-blue-700 cursor-pointer hover:text-blue-800 list-none">
                            <span>{item.q}</span>
                            <span class="transform transition-transform duration-300 group-open:rotate-180 text-blue-600">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
                                </svg>
                            </span>
                        </summary>
                        <p class="text-gray-600 mt-3 leading-relaxed">{item.a}</p>
                    </details>
                ))}
            </div>
        </div>
    </section>

    <section class="py-16 md:py-24 bg-white">
        <div class="container mx-auto px-6 text-center">
            <div class="bg-white p-8 md:p-12 rounded-3xl shadow-2xl max-w-3xl mx-auto">
                <h2 class="text-2xl font-bold text-gray-900 mb-2">{finalCtaHeading}</h2>
                <p class="text-lg text-gray-700 mb-10">{finalCtaText}</p>
                <div class="flex flex-col sm:flex-row justify-center items-center space-y-4 sm:space-y-0 sm:space-x-6">
                     <a href={finalCtaButton2Link} 
                       class="px-8 py-3 rounded-xl font-semibold shadow-md transition duration-300 ease-in-out border-2 border-blue-600 text-blue-600 hover:bg-blue-600 hover:text-white text-lg">
                        {finalCtaButton2Text}
                    </a>
                    <a href={finalCtaButton1Link} 
                       class="px-8 py-3 rounded-xl font-semibold shadow-md transition duration-300 ease-in-out bg-blue-600 text-white hover:bg-blue-700 text-lg">
                        {finalCtaButton1Text}
                    </a>
                </div>
            </div>
        </div>
    </section>
</Layout>